package org.perlonjava;

import org.perlonjava.node.Node;

import java.util.*;
import java.lang.reflect.Constructor;
import java.lang.reflect.Method;
import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;

import javax.script.ScriptEngine;
import javax.script.ScriptEngineManager;
import javax.script.ScriptException;

/**
 * The Main class serves as the entry point for the Perl-to-Java bytecode compiler and runtime
 * evaluator. It parses Perl code, generates corresponding Java bytecode using ASM, and executes the
 * generated bytecode.
 */
public class Main {

    /**
     * The main method initializes the compilation and execution process.
     *
     * @param args Command-line arguments.
     */
    public static void main(String[] args) {
        ArgumentParser.ParsedArguments parsedArgs = ArgumentParser.parseArguments(args);

        if (parsedArgs.code == null) {
            System.err.println("No code provided. Use -e <code> or specify a filename.");
            System.exit(1);
        }

        try {
            PerlLanguageProvider.executePerlCode(
                parsedArgs.code,
                parsedArgs.fileName,
                parsedArgs.debugEnabled,
                parsedArgs.tokenizeOnly,
                parsedArgs.compileOnly,
                parsedArgs.parseOnly
            );
        } catch (Throwable t) {
            t.printStackTrace();
            System.exit(1);
        }
    }
}

